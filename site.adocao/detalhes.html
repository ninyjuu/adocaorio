<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes - Adoção Rio</title>
    <link rel="icon" href="https://scontent-gig4-1.xx.fbcdn.net/v/t1.15752-9/622023872_1604611677336690_5729541255914831690_n.jpg?stp=dst-jpg_s960x960_tt6&_nc_cat=106&ccb=1-7&_nc_sid=9f807c&_nc_ohc=f-nFPiI96CEQ7kNvwHt24F5&_nc_oc=Adn1RZyIP23YnN4VXoHLyYvAVnkW2AWTX4nPrvSCRnYsrdIKIKpvG4faAfawg5JYkxU&_nc_zt=23&_nc_ht=scontent-gig4-1.xx&oh=03_Q7cD4gHt-WGbGD6-dqGYPUNJ4jZy-rcYUc1-M-QLxOYHYd7BYg&oe=69A45F5D" type="image/jpeg">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="script.js"></script>

    <style>
        /* CSS CORRIGIDO PARA MOBILE E CARREGAMENTO */
        .detail-wrapper {
            display: flex !important;
            flex-direction: row !important;
            align-items: flex-start !important;
            gap: 40px !important;
            max-width: 1200px;
            margin: 0 auto;
            background: white; 
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            height: auto; 
        }

        .detail-img-container {
            flex: 1 !important;
            width: 50%;
            height: 500px !important; /* Altura fixa PC */
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            background: #f9f9f9;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #eee; 
            flex-shrink: 0; 
        }

        .slide {
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 100%; 
            object-fit: contain !important;
            display: none;
        }
        .slide.active { display: block; }

        .slide-nav-btn {
            position: absolute; top: 50%; transform: translateY(-50%); z-index: 10;
            background: rgba(59, 30, 122, 0.5); color: white; border: none;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer; transition: 0.3s;
            display: flex; align-items: center; justify-content: center;
        }
        .prev { left: 10px; } .next { right: 10px; }

        .detail-content {
            flex: 1 !important;
            width: 50%;
            display: flex;
            flex-direction: column;
            text-align: left;
            background: transparent;
            padding: 0;
            box-shadow: none;
            height: auto !important; 
            overflow: visible !important;
        }

        @media (max-width: 900px) {
            .detail-wrapper {
                flex-direction: column !important;
                padding: 20px;
                gap: 20px !important;
            }
            .detail-img-container, .detail-content {
                width: 100% !important;
            }
            .detail-img-container { 
                /* Força a caixa a aparecer mesmo se a foto demorar */
                height: 350px !important; 
                min-height: 350px;
                background: #eee;
            }
        }
    </style>
</head>
<body>
    <nav>
        <a href="index.html" class="logo-container">
            <img src="https://scontent-gig4-1.xx.fbcdn.net/v/t1.15752-9/622023872_1604611677336690_5729541255914831690_n.jpg?stp=dst-jpg_s960x960_tt6&_nc_cat=106&ccb=1-7&_nc_sid=9f807c&_nc_ohc=f-nFPiI96CEQ7kNvwHt24F5&_nc_oc=Adn1RZyIP23YnN4VXoHLyYvAVnkW2AWTX4nPrvSCRnYsrdIKIKpvG4faAfawg5JYkxU&_nc_zt=23&_nc_ht=scontent-gig4-1.xx&oh=03_Q7cD4gHt-WGbGD6-dqGYPUNJ4jZy-rcYUc1-M-QLxOYHYd7BYg&oe=69A45F5D" alt="Logo" class="logo-img">
            <span class="logo-text">Adoção Rio</span>
        </a>
        <div class="menu-links"><a href="adocao.html">Voltar</a></div>
    </nav>
    <div class="container">
        <div class="btn-back-container">
            <a href="adocao.html" class="btn-back"><i class="fas fa-arrow-left"></i> Voltar</a>
        </div>
        <div class="detail-wrapper" id="conteudo-detalhe">
            <p style="text-align: center; width: 100%;">Carregando amiguinho...</p>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const idBicho = pegarParametroUrl('id');
            if (!idBicho) return;
            buscarAnimais((animais) => {
                const animal = animais.find(a => a.idFirebase == idBicho);
                if (animal) renderizar(animal);
            });
        });

        function capitalize(s) { return s && s[0].toUpperCase() + s.slice(1); }

        function renderizar(animal) {
            const iconClass = animal.sexo === 'femea' ? 'venus' : 'mars';
            const iconColor = animal.sexo === 'femea' ? '#ff4081' : '#2979ff';
            const faseFormatada = capitalize(animal.fase);
            const subtitulo = [animal.sexo === 'femea' ? 'Fêmea' : 'Macho', animal.porte + ' Porte', faseFormatada].filter(Boolean).join(" | ");

            const listaFotos = (animal.fotos && animal.fotos.length > 0) ? animal.fotos : ['https://via.placeholder.com/600x400?text=Sem+Foto'];
            let slides = listaFotos.map((f, i) => `<img src="${f}" class="slide ${i===0?'active':''}" alt="${animal.nome}">`).join('');
            let setas = listaFotos.length > 1 ? `<button class="slide-nav-btn prev" onclick="mudarSlide(-1)"><i class="fas fa-chevron-left"></i></button><button class="slide-nav-btn next" onclick="mudarSlide(1)"><i class="fas fa-chevron-right"></i></button>` : '';

            document.getElementById('conteudo-detalhe').innerHTML = `
                <div class="detail-img-container">
                    ${setas}
                    ${slides}
                </div>
                <div class="detail-content">
                    <h2 style="font-size: 3.5rem; color: var(--primary-dark); margin:0; line-height: 1.2; display: flex; align-items: center; gap: 15px;">
                        ${animal.nome} <i class="fas fa-${iconClass}" style="color: ${iconColor}; font-size: 2.5rem;"></i>
                    </h2>
                    <div style="font-weight:700; color:var(--primary-dark); margin: 10px 0 20px 0; font-size: 1.2rem;">
                        ${subtitulo}
                    </div>
                    <div style="font-size: 1.1rem; line-height: 1.6; color: #444; flex-grow: 1;">
                        <p style="margin-bottom: 10px;"><strong>Idade:</strong> ${calcularIdade(animal.nasc)}</p>
                        ${animal.caracteristicas ? `<p style="margin-bottom: 10px;"><strong>Características:</strong> ${animal.caracteristicas}</p>` : ''}
                        ${animal.historia ? `<p style="margin-bottom: 10px;"><strong>História:</strong> ${animal.historia}</p>` : ''}
                        ${animal.adaptacao ? `<p style="margin-bottom: 10px;"><strong>Adaptação:</strong> ${animal.adaptacao}</p>` : ''}
                    </div>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLScTHLwKREyuSfOQt47-NwpBidDZ_cCaHgBuq_qxMx7W_UJ89A/viewform" 
                    target="_blank" class="btn-cta" style="margin-top:20px; text-decoration:none; text-align:center; display: flex; justify-content: center; width: 100%;">
                        Adote ${animal.nome}
                    </a>
                </div>
            `;
        }

        let slideIndex = 0;
        function mudarSlide(n) {
            const s = document.querySelectorAll(".slide");
            if (s.length <= 1) return;
            s[slideIndex].classList.remove("active");
            slideIndex = (slideIndex + n + s.length) % s.length;
            s[slideIndex].classList.add("active");
        }
    </script>
    <footer>
        <div class="wave-top"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path></svg></div>
        <div class="footer-container">
            <div class="footer-section">
                <h3>Entre em contato</h3>
                <div class="contact-item"><i class="fab fa-instagram"></i> adocaorio</div>
                <div class="contact-item"><i class="fas fa-envelope"></i> adocaorio@gmail.com</div>
            </div>
            <div class="footer-section">
                <h3>Como ajudar</h3>
                <p>Doe para arcarmos com os cuidados dos abrigados!</p>
                <div class="pix-box">Pix: adocaorio@gmail.com</div>
            </div>
        </div>
    </footer>
</body>
</html>